/**
* Highcharts Connectors for Morningstar Direct Web Services v1.2.0 (2025-05-13)
* (c) 2009-2024 Highsoft AS
* License: https://shop.highcharts.com/contact/partner-data
**/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("highcharts/connectors-morningstar",[],t):"object"==typeof exports?exports["@highcharts/connectors-morningstar"]=t():(e.HighchartsConnectors=e.HighchartsConnectors||{},e.HighchartsConnectors.Morningstar=t())}(this,(()=>(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{AssetAllocationsConverter:()=>Ne,BondStatisticsConverter:()=>Ye,CountryExposureConverter:()=>Be,GlobalStockSectorBreakdownConverter:()=>Le,GoalAnalysisConnector:()=>ke,GoalAnalysisConverter:()=>de,IndustryBreakdownConverter:()=>Ge,IndustryGroupBreakdownConverter:()=>He,InvestmentScreenerConnector:()=>ht,InvestmentScreenerConverter:()=>ut,InvestorPreferencesConnector:()=>wt,InvestorPreferencesConverter:()=>gt,MarketCapConverter:()=>Ue,MetaConverter:()=>qe,PortfolioHoldingsConverter:()=>Fe,RNANewsConnector:()=>it,RNANewsConverter:()=>nt,RegionalExposureConverter:()=>Ve,RiskScoreConnector:()=>It,RiskScoreConverter:()=>St,SecurityCompareConnector:()=>Qe,SecurityDetailsConnector:()=>Je,Shared:()=>s,TimeSeriesConnector:()=>Zt,TimeSeriesConverter:()=>kt,TimeSeriesConverters:()=>o,TrailingPerformanceConverter:()=>_e,XRayConnector:()=>is,XRayConverter:()=>ss,default:()=>as,version:()=>me});var s={};e.r(s),e.d(s,{MorningstarAPI:()=>be,MorningstarAccess:()=>ge,MorningstarError:()=>we,MorningstarRegion:()=>pe,MorningstarSecurityType:()=>Et,MorningstarURL:()=>Me,default:()=>jt,isMorningstarHoldingAmountOptions:()=>Tt,isMorningstarHoldingValueOptions:()=>At,isMorningstarHoldingWeightOptions:()=>Mt,isPostmanEnvironmentJSON:()=>Re});var n,o={};e.r(o),e.d(o,{CumulativeReturnSeriesConverter:()=>_t,DividendSeriesConverter:()=>Vt,GrowthSeriesConverter:()=>Bt,OHLCVSeriesConverter:()=>Ut,PriceSeriesConverter:()=>Ht,RatingSeriesConverter:()=>qt,ReturnSeriesConverter:()=>Wt,RollingReturnSeriesConverter:()=>Xt,default:()=>Kt}),function(e){e.SVG_NS="http://www.w3.org/2000/svg",e.product="Highcharts",e.version="2.3.0",e.win="undefined"!=typeof window?window:{},e.doc=e.win.document,e.svg=e.doc&&e.doc.createElementNS&&!!e.doc.createElementNS(e.SVG_NS,"svg").createSVGRect,e.userAgent=e.win.navigator&&e.win.navigator.userAgent||"",e.isChrome=e.win.chrome,e.isFirefox=-1!==e.userAgent.indexOf("Firefox"),e.isMS=/(edge|msie|trident)/i.test(e.userAgent)&&!e.win.opera,e.isSafari=!e.isChrome&&-1!==e.userAgent.indexOf("Safari"),e.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(e.userAgent),e.isWebKit=-1!==e.userAgent.indexOf("AppleWebKit"),e.deg2rad=2*Math.PI/360,e.hasBidiBug=e.isFirefox&&parseInt(e.userAgent.split("Firefox/")[1],10)<4,e.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],e.noop=function(){},e.supportsPassiveEvents=function(){let t=!1;if(!e.isMS){const s=Object.defineProperty({},"passive",{get:function(){t=!0}});e.win.addEventListener&&e.win.removeEventListener&&(e.win.addEventListener("testPassive",e.noop,s),e.win.removeEventListener("testPassive",e.noop,s))}return t}(),e.charts=[],e.composed=[],e.dateFormats={},e.seriesTypes={},e.symbolSizes={},e.chartCount=0}(n||(n={}));const r=n,{charts:i,doc:a,win:l}=r;function c(e,t,s,n){const o=t?"Highcharts error":"Highcharts warning";32===e&&(e=`${o}: Deprecated member`);const i=g(e);let a=i?`${o} #${e}: www.highcharts.com/errors/${e}/`:e.toString();if(void 0!==n){let e="";i&&(a+="?"),P(n,(function(t,s){e+=`\n - ${s}: ${t}`,i&&(a+=encodeURI(s)+"="+encodeURI(t))})),a+=e}T(r,"displayError",{chart:s,code:e,message:a,params:n},(function(){if(t)throw new Error(a);l.console&&-1===c.messages.indexOf(a)&&console.warn(a)})),c.messages.push(a)}!function(e){e.messages=[]}(c||(c={}));function u(e,t){return parseInt(e,t||10)}function d(e){return"string"==typeof e}function h(e){const t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t}function p(e,t){return!(!e||"object"!=typeof e||t&&h(e))}function f(e){return p(e)&&"number"==typeof e.nodeType}function m(e){const t=e&&e.constructor;return!(!p(e,!0)||f(e)||!t||!t.name||"Object"===t.name)}function g(e){return"number"==typeof e&&!isNaN(e)&&e<1/0&&e>-1/0}function y(e){return null!=e}function w(e,t,s){const n=d(t)&&!y(s);let o;const r=(t,s)=>{y(t)?e.setAttribute(s,t):n?(o=e.getAttribute(s),o||"class"!==s||(o=e.getAttribute(s+"Name"))):e.removeAttribute(s)};return d(t)?r(s,t):P(t,r),o}function C(e){return h(e)?e:[e]}function v(e,t){let s;for(s in e||(e={}),t)e[s]=t[s];return e}function b(){const e=arguments,t=e.length;for(let s=0;s<t;s++){const t=e[s];if(null!=t)return t}}function S(e,t){v(e.style,t)}function R(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))}function D(e,t){return e>1e14?e:parseFloat(e.toPrecision(t||14))}Math.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)};const I=Array.prototype.find?function(e,t){return e.find(t)}:function(e,t){let s;const n=e.length;for(s=0;s<n;s++)if(t(e[s],s))return e[s]};function P(e,t,s){for(const n in e)Object.hasOwnProperty.call(e,n)&&t.call(s||e[n],e[n],n,e)}function E(e,t,s){function n(t,s){const n=e.removeEventListener;n&&n.call(e,t,s,!1)}function o(s){let o,r;e.nodeName&&(t?(o={},o[t]=!0):o=s,P(o,(function(e,t){if(s[t])for(r=s[t].length;r--;)n(t,s[t][r].fn)})))}const r="function"==typeof e&&e.prototype||e;if(Object.hasOwnProperty.call(r,"hcEvents")){const e=r.hcEvents;if(t){const r=e[t]||[];s?(e[t]=r.filter((function(e){return s!==e.fn})),n(t,s)):(o(e),e[t]=[])}else o(e),delete r.hcEvents}}function T(e,t,s,n){if(s=s||{},a.createEvent&&(e.dispatchEvent||e.fireEvent&&e!==r)){const n=a.createEvent("Events");n.initEvent(t,!0,!0),s=v(n,s),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(t,s)}else if(e.hcEvents){s.target||v(s,{preventDefault:function(){s.defaultPrevented=!0},target:e,type:t});const n=[];let o=e,r=!1;for(;o.hcEvents;)Object.hasOwnProperty.call(o,"hcEvents")&&o.hcEvents[t]&&(n.length&&(r=!0),n.unshift.apply(n,o.hcEvents[t])),o=Object.getPrototypeOf(o);r&&n.sort(((e,t)=>e.order-t.order)),n.forEach((t=>{!1===t.fn.call(e,s)&&s.preventDefault()}))}n&&!s.defaultPrevented&&n.call(e,s)}let A;P({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},(function(e,t){r[t]=function(s){return c(32,!1,void 0,{[`Highcharts.${t}`]:`use Array.${e}`}),Array.prototype[e].apply(s,[].slice.call(arguments,1))}}));const M=function(){const e=Math.random().toString(36).substring(2,9)+"-";let t=0;return function(){return"highcharts-"+(A?"":e)+t++}}();l.jQuery&&(l.jQuery.fn.highcharts=function(){const e=[].slice.call(arguments);if(this[0])return e[0]?(new(r[d(e[0])?e.shift():"Chart"])(this[0],e[0],e[1]),this):i[w(this[0],"data-highcharts-chart")]});const j={addEvent:function(e,t,s,n={}){const o="function"==typeof e&&e.prototype||e;Object.hasOwnProperty.call(o,"hcEvents")||(o.hcEvents={});const i=o.hcEvents;r.Point&&e instanceof r.Point&&e.series&&e.series.chart&&(e.series.chart.runTrackerClick=!0);const a=e.addEventListener;a&&a.call(e,t,s,!!r.supportsPassiveEvents&&{passive:void 0===n.passive?-1!==t.indexOf("touch"):n.passive,capture:!1}),i[t]||(i[t]=[]);const l={fn:s,order:"number"==typeof n.order?n.order:1/0};return i[t].push(l),i[t].sort(((e,t)=>e.order-t.order)),function(){E(e,t,s)}},arrayMax:function(e){let t=e.length,s=e[0];for(;t--;)e[t]>s&&(s=e[t]);return s},arrayMin:function(e){let t=e.length,s=e[0];for(;t--;)e[t]<s&&(s=e[t]);return s},attr:w,clamp:function(e,t,s){return e>t?e<s?e:s:t},clearTimeout:function(e){y(e)&&clearTimeout(e)},correctFloat:D,createElement:function(e,t,s,n,o){const r=a.createElement(e);return t&&v(r,t),o&&S(r,{padding:"0",border:"none",margin:"0"}),s&&S(r,s),n&&n.appendChild(r),r},crisp:(e,t=0,s)=>{const n=t%2/2,o=s?-1:1;return(Math.round(e*o-n)+n)*o},css:S,defined:y,destroyObjectProperties:function(e,t,s){P(e,(function(n,o){n!==t&&n?.destroy&&n.destroy(),!n?.destroy&&s||delete e[o]}))},diffObjects:function(e,t,s,n){const o={};return function e(t,o,r,i){const a=s?o:t;P(t,(function(s,l){if(!i&&n&&n.indexOf(l)>-1&&o[l]){s=C(s),r[l]=[];for(let t=0;t<Math.max(s.length,o[l].length);t++)o[l][t]&&(void 0===s[t]?r[l][t]=o[l][t]:(r[l][t]={},e(s[t],o[l][t],r[l][t],i+1)))}else p(s,!0)&&!s.nodeType?(r[l]=h(s)?[]:{},e(s,o[l]||{},r[l],i+1),0!==Object.keys(r[l]).length||"colorAxis"===l&&0===i||delete r[l]):(t[l]!==o[l]||l in t&&!(l in o))&&"__proto__"!==l&&"constructor"!==l&&(r[l]=a[l])}))}(e,t,o,0),o},discardElement:function(e){e&&e.parentElement&&e.parentElement.removeChild(e)},erase:function(e,t){let s=e.length;for(;s--;)if(e[s]===t){e.splice(s,1);break}},error:c,extend:v,extendClass:function(e,t){const s=function(){};return v(s.prototype=new e,t),s},find:I,fireEvent:T,getClosestDistance:function(e,t){const s=!t;let n,o,r,i;return e.forEach((e=>{if(e.length>1)for(o=e.length-1,i=o;i>0;i--)r=e[i]-e[i-1],r<0&&!s?(t?.(),t=void 0):r&&(void 0===n||r<n)&&(n=r)})),n},getMagnitude:R,getNestedProperty:function(e,t){const s=e.split(".");for(;s.length&&y(t);){const e=s.shift();if(void 0===e||"__proto__"===e)return;if("this"===e){let e;return p(t)&&(e=t["@this"]),e??t}const n=t[e];if(!y(n)||"function"==typeof n||"number"==typeof n.nodeType||n===l)return;t=n}return t},getStyle:function e(t,s,n){let o;if("width"===s){let s=Math.min(t.offsetWidth,t.scrollWidth);const n=t.getBoundingClientRect&&t.getBoundingClientRect().width;return n<s&&n>=s-1&&(s=Math.floor(n)),Math.max(0,s-(e(t,"padding-left",!0)||0)-(e(t,"padding-right",!0)||0))}if("height"===s)return Math.max(0,Math.min(t.offsetHeight,t.scrollHeight)-(e(t,"padding-top",!0)||0)-(e(t,"padding-bottom",!0)||0));const r=l.getComputedStyle(t,void 0);return r&&(o=r.getPropertyValue(s),b(n,"opacity"!==s)&&(o=u(o))),o},inArray:function(e,t,s){return c(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),t.indexOf(e,s)},insertItem:function(e,t){const s=e.options.index,n=t.length;let o;for(o=e.options.isInternal?n:0;o<n+1;o++)if(!t[o]||g(s)&&s<b(t[o].options.index,t[o]._i)||t[o].options.isInternal){t.splice(o,0,e);break}return o},isArray:h,isClass:m,isDOMElement:f,isFunction:function(e){return"function"==typeof e},isNumber:g,isObject:p,isString:d,keys:function(e){return c(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(e)},merge:function(){let e,t=arguments,s={};const n=function(e,t){return"object"!=typeof e&&(e={}),P(t,(function(s,o){"__proto__"!==o&&"constructor"!==o&&(!p(s,!0)||m(s)||f(s)?e[o]=t[o]:e[o]=n(e[o]||{},s))})),e};!0===t[0]&&(s=t[1],t=Array.prototype.slice.call(t,2));const o=t.length;for(e=0;e<o;e++)s=n(s,t[e]);return s},normalizeTickInterval:function(e,t,s,n,o){let r,i=e;const a=e/(s=b(s,R(e)));for(t||(t=o?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===n&&(1===s?t=t.filter((function(e){return e%1==0})):s<=.1&&(t=[1/s]))),r=0;r<t.length&&(i=t[r],!(o&&i*s>=e||!o&&a<=(t[r]+(t[r+1]||t[r]))/2));r++);return i=D(i*s,-Math.round(Math.log(.001)/Math.LN10)),i},objectEach:P,offset:function(e){const t=a.documentElement,s=e.parentElement||e.parentNode?e.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:s.top+(l.pageYOffset||t.scrollTop)-(t.clientTop||0),left:s.left+(l.pageXOffset||t.scrollLeft)-(t.clientLeft||0),width:s.width,height:s.height}},pad:function(e,t,s){return new Array((t||2)+1-String(e).replace("-","").length).join(s||"0")+e},pick:b,pInt:u,pushUnique:function(e,t){return e.indexOf(t)<0&&!!e.push(t)},relativeLength:function(e,t,s){return/%$/.test(e)?t*parseFloat(e)/100+(s||0):parseFloat(e)},removeEvent:E,replaceNested:function(e,...t){let s,n;do{for(n of(s=e,t))e=e.replace(n[0],n[1])}while(e!==s);return e},splat:C,stableSort:function(e,t){const s=e.length;let n,o;for(o=0;o<s;o++)e[o].safeI=o;for(e.sort((function(e,s){return n=t(e,s),0===n?e.safeI-s.safeI:n})),o=0;o<s;o++)delete e[o].safeI},syncTimeout:function(e,t,s){return t>0?setTimeout(e,t,s):(e.call(0,s),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:M,useSerialIds:function(e){return A=b(e,A)},wrap:function(e,t,s){const n=e[t];e[t]=function(){const e=arguments,t=this;return s.apply(this,[function(){return n.apply(t,arguments.length?arguments:e)}].concat([].slice.call(arguments)))}}},k=j,{addEvent:x,fireEvent:$,merge:O}=k;class _{benchmark(e,t){const s=[],n=this,o=()=>{n.modifyTable(e),n.emit({type:"afterBenchmarkIteration"})},{iterations:r}=O({iterations:1},t);n.on("afterBenchmarkIteration",(()=>{s.length!==r?o():n.emit({type:"afterBenchmark",results:s})}));const i={startTime:0,endTime:0};return n.on("modify",(()=>{i.startTime=window.performance.now()})),n.on("afterModify",(()=>{i.endTime=window.performance.now(),s.push(i.endTime-i.startTime)})),o(),s}emit(e){$(this,e.type,e)}modify(e,t){const s=this;return new Promise(((n,o)=>{e.modified===e&&(e.modified=e.clone(!1,t));try{n(s.modifyTable(e,t))}catch(n){s.emit({type:"error",detail:t,table:e}),o(n)}}))}modifyCell(e,t,s,n,o){return this.modifyTable(e)}modifyColumns(e,t,s,n){return this.modifyTable(e)}modifyRows(e,t,s,n){return this.modifyTable(e)}on(e,t){return x(this,e,t)}}!function(e){e.types={},e.registerType=function(t,s){return!!t&&!e.types[t]&&!!(e.types[t]=s)}}(_||(_={}));const N=_,{addEvent:V,defined:L,fireEvent:B,uniqueKey:F}=k;class U{static isNull(e){if(e===U.NULL)return!0;if(e instanceof Array){if(!e.length)return!1;for(let t=0,s=e.length;t<s;++t)if(null!==e[t])return!1}else{const t=Object.keys(e);if(!t.length)return!1;for(let s=0,n=t.length;s<n;++s)if(null!==e[t[s]])return!1}return!0}constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||F(),this.modified=this,this.rowCount=0,this.versionTag=F();const t=e.columns||{},s=Object.keys(t),n=this.columns;let o=0;for(let e,r,i=0,a=s.length;i<a;++i)r=s[i],e=t[r].slice(),n[r]=e,o=Math.max(o,e.length);for(let e=0,t=s.length;e<t;++e)n[s[e]].length=o;this.rowCount=o}clone(e,t){const s=this,n={};s.emit({type:"cloneTable",detail:t}),e||(n.columns=s.columns),s.autoId||(n.id=s.id);const o=new U(n);return e||(o.versionTag=s.versionTag,o.originalRowIndexes=s.originalRowIndexes,o.localRowIndexes=s.localRowIndexes),s.emit({type:"afterCloneTable",detail:t,tableClone:o}),o}deleteColumns(e,t){const s=this,n=s.columns,o={},r={},i=s.modifier,a=s.rowCount;if((e=e||Object.keys(n)).length){s.emit({type:"deleteColumns",columnNames:e,detail:t});for(let t,s,i=0,l=e.length;i<l;++i)s=e[i],t=n[s],t&&(o[s]=t,r[s]=new Array(a)),delete n[s];return Object.keys(n).length||(s.rowCount=0,this.deleteRowIndexReferences()),i&&i.modifyColumns(s,r,0,t),s.emit({type:"afterDeleteColumns",columns:o,columnNames:e,detail:t}),o}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(e,t=1,s){const n=this,o=[],r=[],i=n.modifier;if(n.emit({type:"deleteRows",detail:s,rowCount:t,rowIndex:e||0}),void 0===e&&(e=0,t=n.rowCount),t>0&&e<n.rowCount){const s=n.columns,i=Object.keys(s);for(let a,l,c=0,u=i.length;c<u;++c){a=s[i[c]],l=a.splice(e,t),c||(n.rowCount=a.length);for(let e=0,t=l.length;e<t;++e)o[e]=o[e]||[],o[e][c]=l[e];r.push(new Array(u))}}return i&&i.modifyRows(n,r,e||0,s),n.emit({type:"afterDeleteRows",detail:s,rowCount:t,rowIndex:e||0,rows:o}),o}emit(e){const t=this;switch(e.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":t.versionTag=F()}B(t,e.type,e)}getCell(e,t){const s=this.columns[e];if(s)return s[t]}getCellAsBoolean(e,t){const s=this.columns[e];return!(!s||!s[t])}getCellAsNumber(e,t,s){const n=this.columns[e];let o=n&&n[t];switch(typeof o){case"boolean":return o?1:0;case"number":return isNaN(o)&&!s?null:o}return o=parseFloat(`${o??""}`),isNaN(o)&&!s?null:o}getCellAsString(e,t){const s=this.columns[e];return`${s&&s[t]}`}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(e,t){const s=this,n=s.columns[e],o=[];if(n){const r=n.length;if(t)for(let t=0;t<r;++t)o.push(s.getCellAsNumber(e,t,!0));else{for(let e,t=0;t<r;++t){if(e=n[t],"number"==typeof e)return n.slice();if(null!=e)break}for(let t=0;t<r;++t)o.push(s.getCellAsNumber(e,t))}}return o}getColumnNames(){return Object.keys(this.columns)}getColumns(e,t){const s=this.columns,n={};for(let o,r,i=0,a=(e=e||Object.keys(s)).length;i<a;++i)r=e[i],o=s[r],o&&(n[r]=t?o:o.slice());return n}getLocalRowIndex(e){const{localRowIndexes:t}=this;return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){const{originalRowIndexes:t}=this;return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,s){const n=this.columns[e];if(n){const e=n.indexOf(t,s);if(-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(e=0,t=this.rowCount-e,s){const n=this,o=n.columns,r=new Array(t);s=s||Object.keys(o);for(let i,a,l=e,c=0,u=Math.min(n.rowCount,e+t);l<u;++l,++c){a=r[c]={};for(const e of s)i=o[e],a[e]=i?i[l]:void 0}return r}getRows(e=0,t=this.rowCount-e,s){const n=this,o=n.columns,r=new Array(t);s=s||Object.keys(o);for(let i,a,l=e,c=0,u=Math.min(n.rowCount,e+t);l<u;++l,++c){a=r[c]=[];for(const e of s)i=o[e],a.push(i?i[l]:void 0)}return r}getVersionTag(){return this.versionTag}hasColumns(e){const t=this.columns;for(let s,n=0,o=e.length;n<o;++n)if(s=e[n],!t[s])return!1;return!0}hasRowWith(e,t){const s=this.columns[e];return!!s&&-1!==s.indexOf(t)}on(e,t){return V(this,e,t)}renameColumn(e,t){const s=this.columns;return!!s[e]&&(e!==t&&(s[t]=s[e],delete s[e]),!0)}setCell(e,t,s,n){const o=this,r=o.columns,i=o.modifier;let a=r[e];a&&a[t]===s||(o.emit({type:"setCell",cellValue:s,columnName:e,detail:n,rowIndex:t}),a||(a=r[e]=new Array(o.rowCount)),t>=o.rowCount&&(o.rowCount=t+1),a[t]=s,i&&i.modifyCell(o,e,t,s),o.emit({type:"afterSetCell",cellValue:s,columnName:e,detail:n,rowIndex:t}))}setColumn(e,t=[],s=0,n){this.setColumns({[e]:t},s,n)}setColumns(e,t,s){const n=this,o=n.columns,r=n.modifier,i=void 0===t,a=Object.keys(e);n.emit({type:"setColumns",columns:e,columnNames:a,detail:s,rowIndex:t});for(let s,r,l=0,c=a.length;l<c;++l)if(r=a[l],s=e[r],i)o[r]=s.slice(),n.rowCount=s.length;else{const e=o[r]?o[r]:o[r]=new Array(n.rowCount);for(let n=t||0,o=s.length;n<o;++n)e[n]=s[n];n.rowCount=Math.max(n.rowCount,e.length)}const l=Object.keys(o);for(let e=0,t=l.length;e<t;++e)o[l[e]].length=n.rowCount;r&&r.modifyColumns(n,e,t||0),n.emit({type:"afterSetColumns",columns:e,columnNames:a,detail:s,rowIndex:t})}setModifier(e,t){const s=this;let n;return s.emit({type:"setModifier",detail:t,modifier:e,modified:s.modified}),s.modified=s,s.modifier=e,n=e?e.modify(s):Promise.resolve(s),n.then((s=>(s.emit({type:"afterSetModifier",detail:t,modifier:e,modified:s.modified}),s))).catch((t=>{throw s.emit({type:"setModifierError",error:t,modifier:e,modified:s.modified}),t}))}setOriginalRowIndexes(e,t=!1){if(this.originalRowIndexes=e,t)return;const s=this.localRowIndexes=[];for(let t,n=0,o=e.length;n<o;++n)t=e[n],L(t)&&(s[t]=n)}setRow(e,t,s){this.setRows([e],t,s)}setRows(e,t=this.rowCount,s){const n=this,o=n.columns,r=Object.keys(o),i=n.modifier,a=e.length;n.emit({type:"setRows",detail:s,rowCount:a,rowIndex:t,rows:e});for(let s,n=0,i=t;n<a;++n,++i)if(s=e[n],s===U.NULL)for(let e=0,t=r.length;e<t;++e)o[r[e]][i]=null;else if(s instanceof Array)for(let e=0,t=r.length;e<t;++e)o[r[e]][i]=s[e];else{const e=Object.keys(s);for(let t,n=0,r=e.length;n<r;++n)t=e[n],o[t]||(o[t]=new Array(i+1)),o[t][i]=s[t]}const l=t+a;if(l>n.rowCount){n.rowCount=l;for(let e=0,t=r.length;e<t;++e)o[r[e]].length=l}i&&i.modifyRows(n,e,t),n.emit({type:"afterSetRows",detail:s,rowCount:a,rowIndex:t,rows:e})}}U.NULL={},U.version="1.0.0";const G=U,{addEvent:H,fireEvent:Y,merge:q,pick:z}=k;class W{constructor(e={}){this.table=new G(e.dataTable),this.metadata=e.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(e,t){const s=this.metadata.columns;s[e]=q(s[e]||{},t)}describeColumns(e){const t=this,s=Object.keys(e);let n;for(;"string"==typeof(n=s.pop());)t.describeColumn(n,e[n])}emit(e){Y(this,e.type,e)}getColumnOrder(e){const t=this.metadata.columns,s=Object.keys(t||{});if(s.length)return s.sort(((e,s)=>z(t[e].index,0)-z(t[s].index,0)))}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return Y(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return H(this,e,t)}save(){return Y(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))}setColumnOrder(e){const t=this;for(let s=0,n=e.length;s<n;++s)t.describeColumn(e[s],{index:s})}setModifierOptions(e){const t=e&&N.types[e.type];return this.table.setModifier(t?new t(e):void 0).then((()=>this))}startPolling(e=1e3){const t=this;window.clearTimeout(t._polling),t._polling=window.setTimeout((()=>t.load().catch((e=>t.emit({type:"loadError",error:e,table:t.table}))).then((()=>{t._polling&&t.startPolling(e)}))),e)}stopPolling(){window.clearTimeout(this._polling),delete this._polling}whatIs(e){return this.metadata.columns[e]}}!function(e){e.types={},e.registerType=function(t,s){return!!t&&!e.types[t]&&!!(e.types[t]=s)}}(W||(W={}));const J=W,{addEvent:X,fireEvent:K,isNumber:Z,merge:Q}=k;class ee{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){const t=new Date;if(!e)return NaN;let s=+e[4];return s>t.getFullYear()-2e3?s+=1900:s+=2e3,Date.UTC(s,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};const t=Q(ee.defaultOptions,e);let s=t.decimalPoint;"."!==s&&","!==s||(s="."===s?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+s+"([0-9]+)$")),this.options=t}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){const t=this;return{number:t.asNumber,Date:t.asDate,string:t.asString}[t.guessType(e)].call(t,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;if("string"==typeof e){const t=this.decimalRegExp;if(e.indexOf(" ")>-1&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}return e instanceof Date?e.getDate():e?e.getRowCount():NaN}asString(e){return""+e}deduceDateFormat(e,t,s){const n=this,o=[],r=[];let i,a,l,c="YYYY/mm/dd",u=[],d=0,h=!1;for((!t||t>e.length)&&(t=e.length);d<t;d++)if(void 0!==e[d]&&e[d]&&e[d].length)for(i=e[d].trim().replace(/[\-\.\/]/g," ").split(" "),u=["","",""],l=0;l<i.length;l++)l<u.length&&(a=parseInt(i[l],10),a&&(r[l]=!r[l]||r[l]<a?a:r[l],void 0!==o[l]?o[l]!==a&&(o[l]=!1):o[l]=a,a>31?u[l]=a<100?"YY":"YYYY":a>12&&a<=31?(u[l]="dd",h=!0):u[l].length||(u[l]="mm")));if(h){for(l=0;l<o.length;l++)!1!==o[l]?r[l]>12&&"YY"!==u[l]&&"YYYY"!==u[l]&&(u[l]="YY"):r[l]>12&&"mm"===u[l]&&(u[l]="dd");3===u.length&&"dd"===u[1]&&"dd"===u[2]&&(u[2]="YY"),c=u.join("/")}return s&&(n.options.dateFormat=c),c}emit(e){K(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")}getTable(){throw new Error("Not implemented")}guessType(e){const t=this;let s="string";if("string"==typeof e){const n=t.trim(`${e}`),o=t.decimalRegExp;let r=t.trim(n,!0);o&&(r=o.test(r)?r.replace(o,"$1.$2"):"");const i=parseFloat(r);if(+r===i)e=i;else{const n=t.parseDate(e);s=Z(n)?"Date":"string"}}return"number"==typeof e&&(s=e>31536e6?"Date":"number"),s}on(e,t){return X(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")}parseDate(e,t){const s=this,n=s.options;let o,r,i,a=t||n.dateFormat,l=NaN;if(n.parseDate)l=n.parseDate(e);else{if(a)r=s.dateFormats[a],r||(r=s.dateFormats["YYYY/mm/dd"]),i=e.match(r.regex),i&&(l=r.parser(i));else for(o in s.dateFormats)if(r=s.dateFormats[o],i=e.match(r.regex),i){a=o,l=r.parser(i);break}i||(i=Date.parse(e),"object"==typeof i&&null!==i&&i.getTime?l=i.getTime()-6e4*i.getTimezoneOffset():Z(i)&&(l=i-6e4*new Date(i).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(l).getFullYear()&&(l=NaN)))}return l}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}ee.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},function(e){e.getTableFromColumns=function(e=[],t=[]){const s=new G;for(let n=0,o=Math.max(t.length,e.length);n<o;++n)s.setColumn(t[n]||`${n}`,e[n]);return s}}(ee||(ee={}));const te=ee,se=globalThis.window.Dashboards,ne=globalThis.window.DataGrid,oe=se?.DataConnector||ne?.DataConnector||J,re=se?.DataConverter||ne?.DataConverter||te,ie=se?.DataTable||ne?.DataTable||G,ae={DataConnector:oe,DataConverter:re,DataTable:ie};var le;!function(e){e.isGoalAnalysisResponse=function(e){return!!e&&"object"==typeof e&&"number"==typeof e.annualisedRequiredReturn&&"object"==typeof e.probabilityAccumulate&&e.probabilityAccumulate instanceof Array&&(0===e.probabilityAccumulate.length||function(e){return!!e&&"object"==typeof e&&"number"==typeof e.Amount&&"number"==typeof e.probability}(e.probabilityAccumulate[0]))&&"object"==typeof e.seriesData&&e.seriesData instanceof Array&&(0===e.seriesData.length||function(e){return!!e&&"object"==typeof e&&"number"==typeof e.probability&&"object"==typeof e.data&&e.data instanceof Array&&(0===e.data.length||"number"==typeof e.data[0])}(e.seriesData[0]))}}(le||(le={}));const ce=le;const ue=class extends re{constructor(e={}){super(e),this.options=e,this.table=new ie}getTable(){return this.table}};class de extends ue{constructor(e){super(e),this.metadata={annualisedRequiredReturn:0,columns:{},expectedReturn:0,financialGoal:0,probabilityOfReachingTarget:0,requiredReturn:0,requiredReturnValue:0,standardDeviation:0,totalGain:0,totalInvestment:0,totalReturn:0,years:0}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json;if(!ce.isGoalAnalysisResponse(n))throw new Error("Invalid data");s.deleteColumns(),s.setColumn("Goal_Probability"),s.setColumn("Goal_Amount");let o=n.seriesData?.[0]?.data;for(let e=0,t=o.length;e<t;++e)s.setColumn(`Goal_AssetClass_${e}`);let r=0,i=0;for(const e of n.probabilityAccumulate){s.setCell("Goal_Probability",i,e.probability),s.setCell("Goal_Amount",i,e.Amount),r=0,o=n.seriesData?.[i]?.data;for(const e of o)s.setCell(`Goal_AssetClass_${r}`,i,e),++r;++i}t.annualisedRequiredReturn=n.annualisedRequiredReturn,t.expectedReturn=n.expectedReturn,t.financialGoal=n.financialGoal,t.probabilityOfReachingTarget=n.probabilityOfReachingTarget,t.requiredReturn=n.requiredReturn,t.requiredReturnValue=n.requiredReturnValue,t.standardDeviation=n.standardDeviation,t.totalGain=n.totalGain,t.totalInvestment=n.totalInvestment,t.totalReturn=n.totalReturn,t.years=n.years}}const he=de;var pe;!function(e){const t=["AG","AI","AR","AW","BB","BL","BM","BO","BQ","BR","BS","BZ","CA","CL","CO","CR","CU","CW","DM","DO","EC","FK","GD","GF","GP","GS","GT","GY","HN","HT","JM","KN","KY","LC","MF","MQ","MS","MX","NI","PA","PE","PM","PR","PY","SR","SV","UM","US","UY","VC","VE","VG","VI"],s=["AD","AE","AL","AM","AO","AT","AX","BA","BE","BF","BG","BH","BI","BJ","BW","BY","CD","CF","CG","CH","CI","CM","CV","CY","CZ","DE","DJ","DK","DZ","EE","EG","EH","ER","ES","ET","EU","FI","FO","FR","GA","GB","GE","GG","GH","GI","GL","GM","GN","GQ","GR","GW","HR","HU","IE","IL","IM","IQ","IR","IS","IT","JE","JO","KE","KW","LB","LI","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MG","MK","ML","MR","MT","MW","MZ","NA","NE","NG","NL","NO","OM","PL","PS","PT","QA","RO","RS","RW","SA","SC","SD","SE","SI","SJ","SK","SL","SM","SN","SO","SS","ST","SX","SY","SZ","TD","TF","TG","TN","TR","TZ","UA","UG","VA","YE","ZA","ZM","ZW"];e.baseURLs={Americas:"https://www.us-api.morningstar.com/",APAC:"https://www.apac-api.morningstar.com/",EMEA:"https://www.emea-api.morningstar.com/"},e.detect=function(){const e=window.navigator.language.toUpperCase().match(/-(\w\w)/u);return e?t.includes(e[1])?"Americas":s.includes(e[1])?"EMEA":"APAC":"Americas"}}(pe||(pe={}));const fe=pe,me="1.2.0";class ge{constructor(e={}){if(this.url=e.url?new URL(e.url,window.location.href):new URL("token/oauth",fe.baseURLs[fe.detect()]),"https:"!==this.url.protocol)throw new Error("Insecure API protocol");e.token&&(this.token=e.token,this.tokenType="Option"),this.setPayload(e.username,e.password),delete e.password,delete e.username}async authenticate(e,t){if(window.clearTimeout(this.timeout),delete this.authorized,delete this.errorMessage,delete this.timeout,"Bearer"===this.tokenType&&(delete this.token,delete this.tokenType),"string"==typeof t&&"string"==typeof e&&this.setPayload(e,t),!this.payload)return this.token&&(this.authorized=!0),!!this.authorized;const s=this.payload,n={cache:"no-cache",credentials:"omit",headers:new Headers({Authorization:`Basic ${s}`,"User-Agent":`HighchartsConnectorsMorningstar/${me}`}),method:"POST",redirect:"error"};delete this.payload;try{const e=await fetch(this.url,n),t=await e.json();200===e.status&&(null!==(o=t)&&"object"==typeof o&&"string"==typeof o.access_token&&"number"==typeof o.expires_in&&"Bearer"===o.token_type)?(this.authorized=!0,this.payload=s,this.token=t.access_token,this.tokenType=t.token_type,this.setTimeout(t.expires_in)):(this.authorized=!1,function(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message}(t)&&(this.errorMessage=t.message))}catch(e){this.authorized=!1,this.errorMessage=""+e}var o;return!!this.authorized}authorizeRequest(e){const t=this.token,s="Option"===this.tokenType?"Bearer":this.tokenType;if(void 0===t||void 0===s)return e;const n=e.headers instanceof Headers?e.headers:new Headers(e.headers);return n.set("Authorization",`${s} ${t}`),e.cache="no-cache",e.credentials="same-origin",e.headers=n,e.redirect="error",e}setPayload(e,t){delete this.payload,"string"==typeof t&&"string"==typeof e&&(e=unescape(encodeURIComponent(e)),t=unescape(encodeURIComponent(t)),this.payload=btoa(`${e}:${t}`))}setTimeout(e){window.clearTimeout(this.timeout),this.timeout=window.setTimeout((()=>{this.authenticate()}),1e3*e)}setToken(e){this.authorized=!0,this.token=e,this.tokenType="Bearer"}}const ye=ge;class we extends Error{constructor(e,t,s,n){super(we.errorMessageMap[t.statusText]||we.statusMessageMap[t.status]||"Unknown Error"),this.request=e,this.response=t,this.submessage=n,this.substatus=s}}!function(e){e.errorMessageMap={},e.statusMessageMap={200:"OK",302:"Found",304:"Not Modified",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",414:"Request URI Too Long",415:"Unsupported Media Type",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"}}(we||(we={}));const Ce=we,ve=new RegExp(["<StatusCode>([^<>]*)</StatusCode>",".*","<StatusMessage>([^<>]*)</StatusMessage>"].join(""),"su");class be{constructor(e={}){if(this.baseURL=new URL(e.url??fe.baseURLs[fe.detect()],window.location.href),"https:"!==this.baseURL.protocol)throw new Error("Insecure API protocol");this.lastRequestTimestamp=0,this.options=e,this.requestDelay=0,this.version=e.version??parseInt((this.baseURL.pathname.match(/\/v(\d+)(?:\/|$)/u)||[])[1],10),this.version=this.version>0?this.version:1,this.access=new ye(e.access)}delay(e){return new Promise((t=>window.setTimeout(t,e)))}async fetch(e,t={}){"compactjson"!==e.searchParams.get("outputType")&&e.searchParams.set("outputType","json");const s=this.requestDelay-((new Date).getTime()-this.lastRequestTimestamp);s>0&&await this.delay(s),this.lastRequestTimestamp=(new Date).getTime(),(this.access.authorized||await this.access.authenticate())&&(t=this.access.authorizeRequest(t));(t.headers instanceof Headers?t.headers:new Headers(t.headers)).set("User-Agent",`HighchartsConnectorsMorningstar/${me}`);const n=await window.fetch(e,t);if(!n.url.startsWith("https"))throw new Error("Unsecured connection");if(n.status>=400)throw new Ce(t,n);const o=n.headers.get("Content-Type");if(o){const e=await n.blob();n.blob=async()=>e,n.json=async()=>JSON.parse(await e.text()),n.text=()=>e.text()}if(o?.startsWith("text/xml")){const e=(await n.text()).match(ve);if(e){const s=e[2].trim(),o=parseInt(e[1]);throw new Ce(t,n,o,s)}throw new Error(`Unexpected data: ${o}`)}if(!o?.startsWith("application/json"))throw new Error(`Unexpected data: ${o}`);const r=parseInt(n.headers.get("X-RateLimit-Limit")||"0",10);return r>0&&(this.requestDelay=36e5/r),n}}const Se=be;function Re(e){return null!==e&&"object"==typeof e&&"string"==typeof e.id&&"string"==typeof e.name&&"object"==typeof e.values&&e.values instanceof Array&&(0===e.values.length||De(e.values[0]))}function De(e){return!(null===e||"object"!=typeof e||"string"!=typeof e.key||"string"!=typeof e.value||"default"!==e.type&&"secret"!==e.type||void 0!==e.enabled&&"boolean"!=typeof e.enabled)}class Ie{static async fromFile(e){return Ie.fromJSON(JSON.parse("string"==typeof e?e:await e.text()))}static fromJSON(e){const t=[];let s="",n="";if(Re(e)){s=e.id,n=e.name;for(const s of e.values)De(s)&&t.push(s)}return new Ie(s,n,t)}static async fromURL(e){return await this.fromFile(await(await fetch(e)).text())}constructor(e,t,s){this.id=e,this.name=t,this.values=s}getAllValuesOf(e){const t=[];if("string"==typeof e)for(const s of this.values)s.key===e&&t.push(s);else for(const s of this.values)e.test(s.key)&&t.push(s);return t}getLastValueOf(e){let t;if("string"==typeof e)for(const s of this.values)s.enabled&&s.key===e&&(t=s);else for(const s of this.values)s.enabled&&e.test(s.key)&&(t=s);return t}getValueOf(e){if("string"==typeof e){for(const t of this.values)if(t.enabled&&t.key===e)return t}else for(const t of this.values)if(t.enabled&&e.test(t.key))return t}}const Pe=Ie;var Ee;!function(e){function t(e){const t={},s=e.getValueOf("Morningstar as a Service Password"),n=e.getValueOf(/^Morningstar as a Service \(/u),o=e.getValueOf("Morningstar as a Service Username");return n&&(t.url=n.value,t.url.startsWith("www.")&&(t.url=`https://${t.url}`)),s&&o&&(t.access={password:s.value,username:o.value},t.url&&n&&(t.access.url=`${t.url}/token/oauth`)),t}e.getAPIOptions=async function(e={}){return e.environmentJSON?t(Pe.fromJSON(e.environmentJSON)):e.environmentURL?t(await Pe.fromURL(e.environmentURL)):{}}}(Ee||(Ee={}));const Te=Ee;const Ae=class extends oe{constructor(e={}){super(e),this.options=e}async load(){const e=this.options;return this.api||(this.api=new Se(e.postman?await Te.getAPIOptions(e.postman):e.api)),this.api.access.authorized||await this.api.access.authenticate(),super.load()}};class Me extends URL{setDate(e,t){const s="number"==typeof t?new Date(t):new Date(Date.parse(t));this.searchParams.set(e,s.toISOString().substring(0,10))}setLocalizationOptions(e){this.searchParams.set("languageId",e.language.toLowerCase()+"-"+e.country.toUpperCase())}setSecuritiesOptions(e){const t=this.searchParams;let s=t.get("id")||"",n=t.get("idType")||"";for(const t of e)s=s?`${s}|${t.id}`:t.id,n=n?`${n}|${t.idType}`:t.idType;t.set("id",s),t.set("idType",n)}}const je=Me;class ke extends Ae{constructor(e={}){super(e),this.converter=new he(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(){await super.load();const e=this.options,t=this.api=this.api||new Se(e.api),s=new je("ecint/v1/goal-analysis",t.baseURL);if(!e.assetClassWeights)throw new Error("Option assetClassWeights is missing.");const n=s.searchParams;n.set("AssetClassWeights",e.assetClassWeights.join("|")),e.annualInvestment&&n.set("annualInvestment",`${e.annualInvestment}`),e.currentSavings&&n.set("currentSavings",`${e.currentSavings}`),"boolean"==typeof e.includeDetailedInvestmentGrowthGraph&&n.set("IncludeDetailedInvestmentGrowthGraph",e.includeDetailedInvestmentGrowthGraph?"True":"False"),e.requestProbability&&n.set("RequestProbability",`${e.requestProbability}`),e.target&&n.set("target",`${e.target}`),e.timeHorizon&&n.set("timeHorizon",`${e.timeHorizon}`);const o=await t.fetch(s),r=await o.json();return this.converter.parse({json:r}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ae.DataConnector.registerType("MorningstarGoalAnalysis",ke);const xe=ke;var $e;!function(e){function t(e){return!!e&&"object"==typeof e&&"string"==typeof e.Id&&"object"==typeof e.Currency&&(0===e.TrailingPerformance.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.ReturnType&&Array.isArray(e.Return)&&function(e){return!!e&&"object"==typeof e&&"number"==typeof e.Value&&"string"==typeof e.TimePeriod&&"string"==typeof e.Date&&(void 0===e.Annualized||"boolean"==typeof e.Annualized)}(e.Return[0])}(e.TrailingPerformance[0]))}e.isSecurityDetails=t,e.isSecurityDetailsResponse=function(e){return Array.isArray(e)&&e.every(t)}}($e||($e={}));const Oe=$e;class _e extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a="TrailingPerformance_TimePeriod"+(o?`_${r}`:""),l="TrailingPerformance_Value"+(o?`_${r}`:"");s.setColumn(a),s.setColumn(l),[].push(r),[].push(i);const c=n.TrailingPerformance[0].Return;for(let e=0,t=c.length;e<t;++e)s.setCell(a,e,c[e].TimePeriod),s.setCell(l,e,c[e].Value);o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Ne extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].AssetAllocations,l="AssetAllocations_Type"+(o?`_${r}`:"");s.setColumn(l);for(let e=0;e<a.length;e++){const t=a[e],n=`AssetAllocations_${t.Type}_${t.SalePosition}`+(o?`_${r}`:"");s.setColumn(n);for(let e=0;e<t.BreakdownValues.length;e++)s.setCell(n,e,t.BreakdownValues[e].Value),s.setCell(l,e,t.BreakdownValues[e].Type)}o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Ve extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].RegionalExposure,l="RegionalExposure_Type"+(o?`_${r}`:""),c="RegionalExposure_NotClassified"+(o?`_${r}`:""),u="RegionalExposure_Assets"+(o?`_${r}`:"");s.setColumn(l),s.setColumn(u),s.setColumn(c);for(let e=0;e<a.length;e++){const t=a[e],n=`RegionalExposure_${t.SalePosition}`+(o?`_${r}`:"");s.setColumn(n),s.setCell(u,e,t.SalePosition),s.setCell(c,e,t.NotClassified);for(let e=0;e<t.BreakdownValues.length;e++)s.setCell(n,e,t.BreakdownValues[e].Value),s.setCell(l,e,t.BreakdownValues[e].Type)}o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Le extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Portfolios[0].GlobalStockSectorBreakdown,i=n.Id,a=n.Isin,l="GlobalStockSectorBreakdown_Type"+(o?`_${i}`:""),c="GlobalStockSectorBreakdown_NotClassified"+(o?`_${i}`:""),u="GlobalStockSectorBreakdown_Assets"+(o?`_${i}`:"");s.setColumn(l),s.setColumn(u),s.setColumn(c);for(let e=0;e<r.length;e++){const t=r[e],n=`GlobalStockSectorBreakdown_${t.SalePosition}`+(o?`_${i}`:"");s.setColumn(n),s.setCell(u,e,t.SalePosition),s.setCell(c,e,t.NotClassified);for(let e=0;e<t.BreakdownValues.length;e++)s.setCell(n,e,t.BreakdownValues[e].Value),s.setCell(l,e,t.BreakdownValues[e].Type)}o?(t.ids?.push(i),t.isins?.push(a)):(t.id=i,t.isin=a)}}class Be extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].CountryExposure,l="CountryExposure_Assets"+(o?`_${r}`:""),c="CountryExposure_NotClassified"+(o?`_${r}`:""),u="CountryExposure_Type"+(o?`_${r}`:"");s.setColumn(l),s.setColumn(c),s.setColumn(u);for(let e=0;e<a.length;e++){const t=a[e],n=`CountryExposure_${t.Type}_${t.SalePosition}`+(o?`_${r}`:"");s.setColumn(n),s.setCell(l,e,`${t.Type}_${t.SalePosition}`),s.setCell(c,e,t.NotClassified);for(let e=0;e<t.BreakdownValues.length;e++)s.setCell(n,e,t.BreakdownValues[e].Value),s.setCell(u,e,t.BreakdownValues[e].Type)}o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Fe extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].PortfolioHoldings;let l=0;for(const e of a){for(const t in e){const n=`PortfolioHoldings_${t}`+(o?`_${r}`:"");s.setCell(n,l,e[t])}++l}o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Ue extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].MarketCapitalBreakdown;We(r,a,s,"MarketCap",!!o),o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Ge extends ue{constructor(e){super(e),this.metadata={columns:{},...e?.hasMultiple&&{ids:[]},...e?.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].IndustryBreakdown;We(r,a,s,"IndustryBreakdown",!!o),o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class He extends ue{constructor(e){super(e),this.metadata={columns:{},...e?.hasMultiple&&{ids:[]},...e?.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].IndustryGroupBreakdown;We(r,a,s,"IndustryGroupBreakdown",!!o),o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}class Ye extends ue{constructor(e){super(e),this.metadata={columns:{},...e?.hasMultiple&&{ids:[]},...e?.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a=n.Portfolios[0].BondStatistics;if(a){for(const e of Object.keys(a)){const t=e+(o?`_${r}`:"");s.setColumn(t),s.setCell(t,0,a[e])}o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}}class qe extends ue{constructor(e){super(e),this.metadata={columns:{},...e&&e.hasMultiple&&{ids:[]},...e&&e.hasMultiple&&{isins:[]}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json,o=e.hasMultiple,r=n.Id,i=n.Isin,a="Meta"+(o?`_${r}`:""),l="Value"+(o?`_${r}`:"");s.setColumn(a),s.setColumn(l);const c=[["Id",n.Id],["InceptionDate",n.InceptionDate],["PerformanceInceptionDate",n.PerformanceInceptionDate],["Isin",n.Isin],["LegalName",n.LegalName],["Domicile",n.Domicile],["OngoingCharge",n.OngoingCharge],["CollectedSRRI_Date",n.CollectedSRRI?.Date],["CollectedSRRI_Rank",n.CollectedSRRI?.Rank],["Currency_Id",n.Currency?.Id],["LastPrice_Date",n.LastPrice?.Date],["LastPrice_Value",n.LastPrice?.Value],["LastPrice_Currency_Id",n.LastPrice?.Currency?.Id],["InvestmentStrategy",n.InvestmentStrategy],["ProviderCompany_Name",n.ProviderCompany?.Name],["ProviderCompany_AddressLine1",n.ProviderCompany?.AddressLine1],["ProviderCompany_Phone",n.ProviderCompany?.Phone],["ProviderCompany_City",n.ProviderCompany?.City],["ProviderCompany_Country",n.ProviderCompany?.Country],["ProviderCompany_PostalCode",n.ProviderCompany?.PostalCode],["ProviderCompany_Homepage",n.ProviderCompany?.Homepage],["CategoryBroadAssetClass_Id",n.CategoryBroadAssetClass?.Id],["CategoryBroadAssetClass_Name",n.CategoryBroadAssetClass?.Name],["ActualManagementFee",n.ActualManagementFee],["FundAttributes_DerivativeBased",n.FundAttributes?.DerivativeBased],["FundAttributes_HedgeFund",n.FundAttributes?.HedgeFund],["FundAttributes_MasterFeeder",n.FundAttributes?.MasterFeeder],["FundAttributes_PhysicalFull",n.FundAttributes?.PhysicalFull],["FundAttributes_PhysicalSample",n.FundAttributes?.PhysicalSample],["FundAttributes_SyntheticReplication",n.FundAttributes?.SyntheticReplication],["FundAttributes_UCITS",n.FundAttributes?.UCITS]];s.setRows(c),o?(t.ids?.push(r),t.isins?.push(i)):(t.id=r,t.isin=i)}}function ze(e,t){switch(e?.type){case"TrailingPerformance":default:return new _e({...e,hasMultiple:t});case"AssetAllocations":return new Ne({...e,hasMultiple:t});case"RegionalExposure":return new Ve({...e,hasMultiple:t});case"GlobalStockSectorBreakdown":return new Le({...e,hasMultiple:t});case"CountryExposure":return new Be({...e,hasMultiple:t});case"PortfolioHoldings":return new Fe({...e,hasMultiple:t});case"MarketCap":return new Ue({...e,hasMultiple:t});case"IndustryBreakdown":return new Ge({...e,hasMultiple:t});case"IndustryGroupBreakdown":return new He({...e,hasMultiple:t});case"BondStatistics":return new Ye({...e,hasMultiple:t});case"Meta":return new qe({...e,hasMultiple:t})}}const We=(e,t,s,n,o)=>{const r=`${n}_Type`+(o?`_${e}`:""),i=`${n}_NotClassified`+(o?`_${e}`:""),a=`${n}_Assets`+(o?`_${e}`:"");s.setColumn(r),s.setColumn(a),s.setColumn(i);for(let l=0;l<t.length;l++){const c=t[l],u=`${n}_${c.SalePosition}`+(o?`_${e}`:"");s.setColumn(u),s.setCell(a,l,c.SalePosition),s.setCell(i,l,c.NotClassified);for(let e=0;e<c.BreakdownValues.length;e++)s.setCell(u,e,c.BreakdownValues[e].Value),s.setCell(r,e,c.BreakdownValues[e].Type)}};class Je extends Ae{constructor(e){super(e),this.converter=ze(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(e){await super.load();const t={...this.options,...e},{security:s,viewId:n="MFsnapshot"}=t,{id:o,idType:r}=s||{},i=this.api=this.api||new Se(t.api),a=new je(`ecint/v1/securities/${o}`,i.baseURL),l=a.searchParams;l.set("idType",""+r),l.set("responseViewFormat","json"),l.set("viewid",n);const c=await i.fetch(a),u=await c.json();if(!Oe.isSecurityDetailsResponse(u))throw new Error("Invalid data");return this.converter.parse({json:u[0]}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(t.dataModifier)}}ae.DataConnector.registerType("MorningstarSecurityDetails",Je);const Xe=Je,Ke="|",Ze=":";class Qe extends Ae{constructor(e){super(e),this.converter=ze(e.converter,!0),this.metadata=this.converter.metadata,this.options=e}async load(e){await super.load();const t={...this.options,...e},{security:s,viewIds:n="MFsnapshot"}=t,{ids:o,idType:r}=s||{},i=this.api=this.api||new Se(t.api),a=new je("ecint/v1/multi-securities/",i.baseURL),l=a.searchParams;l.set("ids",""+o.join(Ke)),l.set("idType",""+r),l.set("responseViewFormat","json"),l.set("viewIds",n);const c=await i.fetch(a),u=await c.json();if(!Oe.isSecurityDetailsResponse(u))throw new Error("Invalid data");this.table.deleteColumns();for(const e of u)this.converter.parse({json:e,hasMultiple:!0});return this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(t.dataModifier)}}ae.DataConnector.registerType("MorningstarSecurityCompare",Qe);const et=Qe;var tt;!function(e){e.isResponse=function(e){return!!e&&Array.isArray(e)&&(0===e.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.day&&"object"==typeof e.items&&function(e){return!!e&&Array.isArray(e)&&4===e.length&&!e.find((e=>"string"!=typeof e))}(e.items[0])}(e[0]))}}(tt||(tt={}));const st=tt;class nt extends ue{constructor(e={}){super(e),this.columns=[],this.header=[],this.options=e}parse(e){if(this.header=["Day","Title","Source","Type"],this.columns=[],!e.json)return!1;if(!st.isResponse(e.json))throw new Error("Invalid data");const t=[];for(const s of e.json){const e=Number(s.day),n=s.items.map((t=>{const[,s,n,o]=t;return[e,s,n,o]}));t.push(...n)}const s=[];for(let e=0;e<this.header.length;e++){const n=[];for(let s=0;s<t.length;s++)n.push(t[s][e]);s.push(n)}return this.columns=s,!0}getTable(){return ue.getTableFromColumns(this.columns,this.header)}}const ot=nt;function rt(e){let t;if("string"==typeof e)if(Number.isNaN(Number(e))){const s=Date.parse(e);if(Number.isNaN(s))throw new Error(`The date ${e} is not a valid date.`);t=s}else t=Number(e);else{if("number"!=typeof e)throw new Error("The provided date is not of type string, nor number.");t=e}return new Date(t).toISOString().substring(0,10)}class it extends Ae{constructor(e={}){super(e),this.converter=new ot(e.converter),this.options=e,void 0===this.options.api?.url&&(this.options.api={...this.options.api??{},url:fe.baseURLs.EMEA})}async load(){await super.load();const e=this.options,{security:t,startDate:s,endDate:n,maxStories:o,localization:r}=e;if(!t)return this;const i=this.api=this.api||new Se(e.api),a=new je("ecint/v1/timeseries/rna-news",i.baseURL);if(a.setSecuritiesOptions([t]),s){const e=rt(s);a.setDate("startDate",e)}if(n){const e=rt(n);a.setDate("endDate",e)}if(o){const e=Number(o);if(!Number.isInteger(e))throw new Error(`Expected maxStories to be integer, but is instead ${o}`);a.searchParams.set("maxStories",""+o)}r&&a.setLocalizationOptions(r);const l=await i.fetch(a),c=await l.json();return this.converter.parse({json:c}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ae.DataConnector.registerType("MorningstarRNANews",it);const at=it;var lt;!function(e){function t(e){return!!e&&"object"==typeof e}e.isInvestmentScreenerResponse=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.rows&&e.rows instanceof Array&&(0===e.rows.length||t(e.rows[0]))},e.isInvestmentScreenerRow=t}(lt||(lt={}));const ct=lt;class ut extends ue{constructor(e){super(e),this.metadata={columns:{}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json;if(!ct.isInvestmentScreenerResponse(n))throw new Error("Invalid data");s.deleteColumns();const o=n.rows;if(o.length>0){const e=o[0];for(const t of Object.keys(e))s.setColumn(`InvestmentScreener_${t}`);for(let e=0;e<o.length;e++)for(const[t,n]of Object.entries(o[e]))s.setCell(`InvestmentScreener_${t}`,e,n);t.page=n.page,t.total=n.total,t.pageSize=n.pageSize}}}const dt=ut;class ht extends Ae{constructor(e={universeIds:[]}){super(e),this.converter=new dt(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(e){await super.load();const t={...this.options,...e};this.api??(this.api=new Se(t.api));const s=this.api,n=new je("ecint/v1/screener",s.baseURL),o=n.searchParams;if(o.set("outputType","json"),o.set("universeIds",t.universeIds.join(Ke)),t.securityDataPoints&&o.set("securityDataPoints",t.securityDataPoints.join(",")),t.filters){const e=t.filters.reduce(((e,t)=>""===e?this.getFilter(t):e+Ke+this.getFilter(t)),"");o.set("filters",e)}t.ignoreRestructure&&o.set("ignoreRestructure",`${t.ignoreRestructure}`),t.term&&o.set("term",t.term),t.applyTrackRecordExtension&&o.set("applyTrackRecordExtension",`${t.applyTrackRecordExtension}`),t.page&&o.set("page",`${t.page}`),t.pageSize&&o.set("pageSize",`${t.pageSize||1}`),t.sortOrder&&o.set("sortOrder",t.sortOrder),t.countryId&&o.set("countryId",t.countryId),t.currencyId&&o.set("currencyId",t.currencyId);const r=await s.fetch(n),i=await r.json();return this.converter.parse({json:i}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(t.dataModifier)}getFilter(e){return`${e.dataPointId}${Ze}${e.comparatorCode}${Ze}${e.value}`}}ae.DataConnector.registerType("MorningstarInvestmentScreener",ht);const pt=ht;var ft;!function(e){function t(e){return!!e&&"object"==typeof e}e.isInvestorPreferencesResponse=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.rows&&e.rows instanceof Array&&(0===e.rows.length||t(e.rows[0]))},e.isInvestorPreferenceRow=t}(ft||(ft={}));const mt=ft;class gt extends ue{constructor(e){super(e),this.metadata={columns:{}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json;if(!mt.isInvestorPreferencesResponse(n))throw new Error("Invalid data");s.deleteColumns();const o=n.rows;if(o.length>0){const e=o[0];for(const t of Object.keys(e))s.setColumn(`InvestorPreferences_${t}`);for(let e=0;e<o.length;e++)for(const[t,n]of Object.entries(o[e]))s.setCell(`InvestorPreferences_${t}`,e,n);t.page=n.page,t.total=n.total,t.pageSize=n.pageSize}}}const yt=gt;class wt extends Ae{constructor(e={universeIds:[]}){super(e),this.converter=new yt(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(e){await super.load();const t={...this.options,...e},s=this.api=this.api||new Se(t.api),n=new je("ecint/v1/screener",s.baseURL),o={universeIds:t.universeIds.join(Ke),outputType:"json"};t.page&&(o.page=`${t.page}`),t.pageSize&&(o.pageSize=`${t.pageSize}`),t.sortOrder&&(o.sortOrder=`${t.sortOrder}`),t.languageId&&(o.languageId=`${t.languageId}`),t.currencyId&&(o.currencyId=`${t.currencyId}`),t.securityDataPoints&&(o.securityDataPoints=t.securityDataPoints),t.calculatedDataPoints&&(this.metadata.calculatedDataPointNames=t.calculatedDataPoints.map((e=>e.name)),o.calculatedDataPoints=t.calculatedDataPoints.map((e=>({...e,type:"bool"})))),t.filters&&(o.filters=t.filters.reduce(((e,t)=>""===e?this.getFilter(t):e+Ke+this.getFilter(t)),"")),t.filterDataPoints&&(o.filterDataPoints=t.filterDataPoints.join(Ke)),t.term&&(o.term=t.term),t.countryId&&(o.countryId=t.countryId),t.applyTrackRecordExtension&&(o.applyTrackRecordExtension=t.applyTrackRecordExtension),t.ignoreRestructure&&(o.ignoreRestructure=t.ignoreRestructure);const r=await s.fetch(n,{body:JSON.stringify(o),headers:{"Content-Type":"application/json"},method:"POST"}),i=await r.json();return this.converter.parse({json:i}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(t.dataModifier)}getFilter(e){return`${e.dataPointId}${Ze}${e.comparatorCode}${Ze}${e.value}`}}ae.DataConnector.registerType("MorningstarInvestorPreferences",wt);const Ct=wt;var vt;!function(e){e.isResponse=function(e){return!!e&&"object"==typeof e&&Array.isArray(e.riskScores)&&(0===e.riskScores.length||function(e){return!!e&&"object"==typeof e&&"object"==typeof e.portfolio&&function(e){return!!e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.riskScore&&"number"==typeof e.alignmentScore&&"number"==typeof e.rSquared&&"number"==typeof e.retainedWeightProxied&&"string"==typeof e.scoringMethodUsed&&"string"==typeof e.effectiveDate}(e.portfolio)&&(void 0===e.metadata||function(e){return!!e&&"object"==typeof e&&function(e){return!!e&&Array.isArray(e)&&(0===e.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.type&&"string"==typeof e.message&&Array.isArray(e.invalidHoldings)&&(0===e.invalidHoldings.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.identifier&&"string"==typeof e.identifierType&&"string"==typeof e.status}(e.invalidHoldings[0]))}(e[0]))}(e.messages)}(e.metadata))}(e.riskScores[0]))}}(vt||(vt={}));const bt=vt;class St extends ue{constructor(e={}){super(e),this.options=e,this.metadata={columns:{},messages:[]}}parse(e){const t=this.table,s={...this.options,...e}.json;if(!bt.isResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.riskScores){const{externalId:t,name:s,effectiveDate:r,riskScore:i,alignmentScore:a,rSquared:l,retainedWeightProxied:c,scoringMethodUsed:u}=e.portfolio;n.push({externalId:t,name:s,effectiveDate:Date.parse(r),riskScore:i,alignmentScore:a,rSquared:l,retainedWeightProxied:c,scoringMethodUsed:u}),void 0!==e.metadata&&e.metadata.messages.length>0&&o.push(...e.metadata.messages)}n.sort(((e,t)=>e.effectiveDate===t.effectiveDate?0:e.effectiveDate<t.effectiveDate?-1:1));const r=n.map((e=>e.name));t.deleteColumns();const i=["EffectiveDate","RiskScore","AlignmentScore","RSquared","RetainedWeightProxied","ScoringMethodUsed"];for(const e of r)for(const s of i)t.setColumn(`${e}_${s}`);for(let e=0;e<n.length;e++){const s=n[e],o=[s.effectiveDate,s.riskScore,s.alignmentScore,s.rSquared,s.retainedWeightProxied,s.scoringMethodUsed];for(let n=0;n<o.length;n++){const r=`${s.name}_${i[n]}`,a=o[n];t.setCell(r,Number(e),a)}}return this.metadata.messages=o,!0}}const Rt=St;function Dt(e,t){let s;for(const n of e){let e;const o=n.name??n.id;if(void 0!==n.weight&&void 0!==n.value)throw new Error(`The holding ${o} in the portfolio ${t} cannot have both weight and value.`);if(void 0!==n.weight)e="weight";else{if(void 0===n.value)throw new Error(`The holding ${o} in the portfolio ${t} does not have a value nor a weight.`);e="value"}if(void 0===s&&(s=e),e!==s)throw new Error(`The holdings in the portfolio ${t} mix and match between using value and weight. This is not allowed.`)}}class It extends Ae{constructor(e={}){super(e),this.converter=new Rt(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(){await super.load();const e=this.options,t=e.portfolios;if(!t||0===t.length)return this;for(const e of t)Dt(e.holdings,e.name);const s={Portfolios:[...t].map((e=>(Object.assign(e,{holdings:e.holdings.map((e=>function(e){const t={identifier:e.id,identifierType:e.idType,name:e.name},s=e;return void 0!==s.weight?t.weight=s.weight:void 0!==s.value&&(t.value=s.value),t}(e)))}),void 0===e.currency&&(e.currency="BAS"),e)))},n=this.api=this.api||new Se(e.api),o=new je("/portfolio-analysis/v1/risk-score",n.baseURL),r=await n.fetch(o,{body:JSON.stringify(s),headers:{"Content-Type":"application/json"},method:"POST"}),i=await r.json();return this.converter.parse({json:i}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ae.DataConnector.registerType("MorningstarRiskScore",It);const Pt=It;var Et;function Tt(e){return!!e&&"object"==typeof e&&("number"==typeof e.amount||"string"==typeof e.amount)&&void 0===e.value&&void 0===e.weight}function At(e){return!!e&&"object"==typeof e&&void 0===e.amount&&("number"==typeof e.value||"string"==typeof e.value)&&void 0===e.weight}function Mt(e){return!!e&&"object"==typeof e&&void 0===e.amount&&void 0===e.value&&("number"==typeof e.weight||"string"==typeof e.weight)}!function(e){e.Bond="BD",e.Cash="CASH",e.CategoryAverage="CA",e.ClosedEndFund="FC",e.EconomicsSeries="EI",e.ExchangeTradedFund="FE",e.Index="XI",e.InsuranceProductFund="FV",e.MoneyMarketFund="FM",e.OpenEndFund="FO",e.Portfolio529="CT",e.SeparateAccount="SA",e.Stock="ST",e.UKLPSubAccounts="VA",e.UnitInvestmentTrust="FI",e.VariableAnnuity="V1"}(Et||(Et={}));const jt={isPostmanEnvironmentJSON:Re,MorningstarAccess:ye,MorningstarAPI:Se,MorningstarError:Ce,MorningstarRegion:fe,MorningstarURL:je};class kt extends ue{decorateURL(e){}}const xt=kt;var $t;!function(e){function t(e){return!!e&&"object"==typeof e&&"object"==typeof e.Security&&e.Security instanceof Array&&(0===e.Security.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.Id&&(void 0===e.CumulativeReturnSeries||e.CumulativeReturnSeries instanceof Array)&&(void 0===e.DividendSeries||e.DividendSeries instanceof Array)&&(void 0===e.RatingSeries||e.RatingSeries instanceof Array)&&(void 0===e.HistoryDetail||e.HistoryDetail instanceof Array)&&(void 0===e.ReturnSeries||e.ReturnSeries instanceof Array)&&(void 0===e.RollingReturn||e.RollingReturn instanceof Array)}(e.Security[0]))}e.isCompactJSONOHLCVResponse=function(e){return function(e){return!!e&&e instanceof Array}(e)&&(0===e.length||function(e){return!!e&&Array.isArray(e)&&6===e.length}(e[0]))},e.isHistory=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.HistoryDetail&&e.HistoryDetail instanceof Array&&(0===e.HistoryDetail.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.EndDate&&"string"==typeof e.Value}(e.HistoryDetail[0]))},e.isResponse=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.TimeSeries&&t(e.TimeSeries)},e.isTimeSeriesResponse=t}($t||($t={}));const Ot=$t;class _t extends xt{constructor(e={type:"CumulativeReturn"}){super(e),this.path="timeseries/cumulativereturn",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Ot.isResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.TimeSeries.Security)if(e.CumulativeReturnSeries){n.push(e.Id);for(const t of e.CumulativeReturnSeries)for(const s of t.HistoryDetail)o.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}o.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let r=0,i=-1;for(const e of o)r!==e.EndDate&&(r=e.EndDate,t.setCell("Date",++i,r)),t.setCell(e.Id,i,e.Value)}}const Nt=_t;class Vt extends xt{constructor(e={type:"Dividend"}){super(e),this.path="timeseries/dividend",this.options=e}parse(e){const t=this.table,s={...this.options,...e},n=s.includeCurrency,o=s.json;if(!Ot.isTimeSeriesResponse(o))throw new Error("Invalid data");const r=[],i=[];for(const e of o.Security)if(e.DividendSeries){r.push(e.Id);for(const t of e.DividendSeries)for(const s of t.HistoryDetail)i.push({CurrencyId:s.Value[0].CurrencyId,EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value[0].value)})}i.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of r)t.setColumn(e),n&&t.setColumn(`${e}_Currency`);let a=0,l=-1;for(const e of i)a!==e.EndDate&&(a=e.EndDate,t.setCell("Date",++l,a)),t.setCell(e.Id,l,e.Value),n&&t.setCell(`${e.Id}_Currency`,l,e.CurrencyId)}}const Lt=Vt;class Bt extends xt{constructor(e={type:"Growth"}){super(e),this.path="timeseries/growth",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Ot.isResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.TimeSeries.Security)if(e.GrowthSeries){n.push(e.Id);for(const t of e.GrowthSeries)for(const s of t.HistoryDetail)o.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}o.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let r=0,i=-1;for(const e of o)r!==e.EndDate&&(r=e.EndDate,t.setCell("Date",++i,r)),t.setCell(e.Id,i,e.Value)}}const Ft=Bt;class Ut extends xt{constructor(e={type:"OHLCV"}){super(e),this.path="timeseries/ohlcv",this.options=e}parse(e){const t=this.table,s={...this.options,...e},n=s.json;if(!Ot.isCompactJSONOHLCVResponse(n))throw new Error("Invalid data");const o=s.securities?.map((e=>e.id))??[],r=[];for(const e of n){const[t,,,,n,i]=e;let[,a,l,c]=e;0===i&&s.replaceZeroWithCloseValue&&(a=n,l=n,c=n),r.push({Id:o[0],Date:t,Value:[a,l,c,n,i]})}r.sort(((e,t)=>e.Date===t.Date?0:e.Date<t.Date?-1:1)),t.deleteColumns();const i=["Open","High","Low","Close","Volume"];t.setColumn("Date");for(const e of o)for(const s of i)t.setColumn(`${e}_${s}`);let a=0,l=-1;for(const e of r){a!==e.Date&&(a=e.Date,t.setCell("Date",++l,a));for(const s in e.Value){const n=`${e.Id}_${i[s]}`,o=e.Value[s];t.setCell(n,l,o)}}}decorateURL(e){e.searchParams.set("outputType","compactjson")}}const Gt=Ut;class Ht extends xt{constructor(e={type:"Price"}){super(e),this.path="timeseries/price",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Ot.isResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.TimeSeries.Security)if(e.HistoryDetail){n.push(e.Id);for(const t of e.HistoryDetail)o.push({EndDate:Date.parse(t.EndDate),Id:e.Id,Value:parseFloat(t.Value)})}o.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let r=0,i=-1;for(const e of o)r!==e.EndDate&&(r=e.EndDate,t.setCell("Date",++i,r)),t.setCell(e.Id,i,e.Value)}decorateURL(e){void 0!==this.options.priceType&&e.searchParams.set("priceType",this.options.priceType)}}const Yt=Ht;class qt extends xt{constructor(e={type:"Rating"}){super(e),this.path="timeseries/rating",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Ot.isTimeSeriesResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.Security)if(e.RatingSeries){n.push(e.Id);for(const t of e.RatingSeries)for(const s of t.HistoryDetail)o.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}o.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let r=0,i=-1;for(const e of o)r!==e.EndDate&&(r=e.EndDate,t.setCell("Date",++i,r)),t.setCell(e.Id,i,e.Value)}}const zt=qt;class Wt extends xt{constructor(e={type:"Return"}){super(e),this.path="timeseries/return",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Ot.isResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.TimeSeries.Security)if(e.ReturnSeries){n.push(e.Id);for(const t of e.ReturnSeries)for(const s of t.HistoryDetail)o.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}o.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let r=0,i=-1;for(const e of o)r!==e.EndDate&&(r=e.EndDate,t.setCell("Date",++i,r)),t.setCell(e.Id,i,e.Value)}}const Jt=Wt;class Xt extends xt{constructor(e={type:"RollingReturn"}){super(e),this.path="timeseries/rollingreturn",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Ot.isResponse(s))throw new Error("Invalid data");const n=[],o=[];for(const e of s.TimeSeries.Security)if(e.RollingReturn){n.push(e.Id);for(const t of e.RollingReturn)for(const s of t.HistoryDetail)o.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}o.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let r=0,i=-1;for(const e of o)r!==e.EndDate&&(r=e.EndDate,t.setCell("Date",++i,r)),t.setCell(e.Id,i,e.Value)}decorateURL(e){void 0!==this.options.rollingPeriod&&e.searchParams.set("rollingPeriod",`${this.options.rollingPeriod}`)}}const Kt={CumulativeReturnSeriesConverter:Nt,DividendSeriesConverter:Lt,GrowthSeriesConverter:Ft,OHLCVSeriesConverter:Gt,PriceSeriesConverter:Yt,RatingSeriesConverter:zt,ReturnSeriesConverter:Jt,RollingReturnSeriesConverter:Xt};class Zt extends Ae{constructor(e={}){switch(super(e),e.series?.type){case"CumulativeReturn":this.converter=new Kt.CumulativeReturnSeriesConverter({...e.converter,...e.series});break;case"Dividend":this.converter=new Kt.DividendSeriesConverter({...e.converter,...e.series});break;case"Growth":this.converter=new Kt.GrowthSeriesConverter({...e.converter,...e.series});break;case"Rating":this.converter=new Kt.RatingSeriesConverter({...e.converter,...e.series});break;case"Price":this.converter=new Kt.PriceSeriesConverter({...e.converter,...e.series});break;case"OHLCV":this.converter=new Kt.OHLCVSeriesConverter({...e.converter,...e.series,securities:e.securities});break;case"Return":this.converter=new Kt.ReturnSeriesConverter({...e.converter,...e.series});break;case"RollingReturn":this.converter=new Kt.RollingReturnSeriesConverter({...e.converter,...e.series});break;default:throw new Error("Invalid series type")}this.options=e}async load(){await super.load();const e=this.options,t=e.currencyId,s=e.endDate,n=e.securities,o=e.startDate,r=e.tax,i=e.frequency;if(!n)return this;const a=this.api=this.api||new Se(e.api),l=new je("ecint/v1/"+this.converter.path,a.baseURL);l.setSecuritiesOptions(n),t&&l.searchParams.set("currencyId",t),s&&l.setDate("endDate",s),o&&l.setDate("startDate",o),r&&l.searchParams.set("tax",r),i&&l.searchParams.set("frequency",i),this.converter.decorateURL(l);const c=await a.fetch(l),u=await c.json();return this.converter.parse({json:u}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ae.DataConnector.registerType("MorningstarTimeSeries",Zt);const Qt=Zt;var es;!function(e){function t(e){return!!e&&"object"==typeof e&&(void 0===e.breakdowns||s(e.breakdowns))&&(void 0===e.historicalPerformanceSeries||function(e){return e instanceof Array&&(0===e.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.frequency&&"string"==typeof e.returnType&&"string"==typeof e.startDate&&"string"==typeof e.timePeriod&&e.returns instanceof Array&&(0===e.returns.length||function(e){return e instanceof Array&&"string"==typeof e[0]&&"number"==typeof e[1]}(e.returns[0]))}(e[0]))}(e.historicalPerformanceSeries))&&("object"==typeof e.trailingPerformance||void 0===e.trailingPerformance)}function s(e){return!!e&&"object"==typeof e&&e.assetAllocation instanceof Array&&(0===e.assetAllocation.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"string"==typeof e.type&&"object"==typeof e.values}(e.assetAllocation[0]))||!e.globalStockSector||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"object"==typeof e.values}(e.globalStockSector?.[0])||!e.regionalExposure||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"object"==typeof e.values}(e.regionalExposure?.[0])||!e.styleBox||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"object"==typeof e.values}(e.styleBox?.[0])}function n(e){return!!e&&"object"==typeof e&&t(e)&&(void 0===e.benchmark||t(e.benchmark))&&(void 0===e.breakdowns||s(e.breakdowns))&&(void 0===e.status||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.detailedStatusMessage&&"number"==typeof e.statusCode&&"string"==typeof e.statusDescription}(e.status))}e.isResponse=function(e){return!!e&&"object"==typeof e&&n(e.XRay)},e.isXRayResponse=n}(es||(es={}));const ts=es;class ss extends ue{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=[];if(ts.isResponse(s))n.push(...s.XRay);else{if(!ts.isXRayResponse(s))throw new Error("Invalid data");n.push(s)}t.deleteColumns();for(const e of n){const t=e.benchmarkId||"XRay";e.benchmark&&this.parseBenchmark(t,e.benchmark),e.historicalPerformanceSeries&&this.parseHistoricalPerformance(t,e.historicalPerformanceSeries),e.trailingPerformance&&this.parseTrailingPerformance(t,e.trailingPerformance),e.breakdowns&&this.parseBreakdowns(t,e.breakdowns),e.riskStatistics&&this.parseRiskStatistics(t,e.riskStatistics),e.underlyHoldings&&this.parseUnderlyHoldings(t,e.underlyHoldings)}}parseBenchmark(e,t){for(const s of t)s.breakdowns&&this.parseBreakdowns(e,s.breakdowns),s.historicalPerformanceSeries&&this.parseHistoricalPerformance(e,s.historicalPerformanceSeries),s.trailingPerformance&&this.parseTrailingPerformance(e,s.trailingPerformance)}parseBreakdowns(e,t){const s=this.table;if(t.assetAllocation)for(const n of t.assetAllocation){const t=`${e}_${n.type}_${n.salePosition}`;s.setColumn(`${t}_Categories`),s.setColumn(`${t}_Values`);const o=n.values,r=Object.keys(o);for(let e=0;e<r.length;e++)s.setCell(`${t}_Categories`,e,r[e]),s.setCell(`${t}_Values`,e,o[parseInt(r[e])])}if(t.regionalExposure)for(const n of t.regionalExposure){const t=`${e}_RegionalExposure_${n.salePosition}`;s.setColumn(`${t}_Categories`),s.setColumn(`${t}_Values`);const o=n.values,r=Object.keys(o);for(let e=0;e<r.length;e++)s.setCell(`${t}_Categories`,e,r[e]),s.setCell(`${t}_Values`,e,o[parseInt(r[e])])}if(t.globalStockSector)for(const n of t.globalStockSector){const t=`${e}_GlobalStockSector_${n.salePosition}`;s.setColumn(`${t}_Categories`),s.setColumn(`${t}_Values`);const o=n.values,r=Object.keys(o);for(let e=0;e<r.length;e++)s.setCell(`${t}_Categories`,e,r[e]),s.setCell(`${t}_Values`,e,o[parseInt(r[e])])}if(t.styleBox)for(const n of t.styleBox){const t=`${e}_StyleBox_${n.salePosition}`;s.setColumn(`${t}_Categories`),s.setColumn(`${t}_Values`);const o=n.values,r=Object.keys(o);for(let e=0;e<r.length;e++)s.setCell(`${t}_Categories`,e,r[e]),s.setCell(`${t}_Values`,e,o[parseInt(r[e])])}}parseRiskStatistics(e,t){const s=this.table;if(t.sharpeRatio)for(const n of t.sharpeRatio){const t=`${e}_SharpeRatio_${n.frequency}_${n.timePeriod}`;s.setCell(t,0,n.value)}if(t.standardDeviation)for(const n of t.standardDeviation){const t=`${e}_StandardDeviation_${n.frequency}_${n.timePeriod}`;s.setCell(t,0,n.value)}}parseHistoricalPerformance(e,t){const s=this.table;for(const n of t){const t=`${e}_${n.returnType}_${n.timePeriod}`,o=`${e}_${n.returnType}_${n.timePeriod}_Value`;let r=0;for(const e of n.returns)s.setCell(t,r,e[0]),s.setCell(o,r,e[1]),++r}}parseTrailingPerformance(e,t){const s=this.table;for(const n of t){const t=`${e}_${n.type}_TimePeriod`,o=`${e}_${n.type}_Value`;let r=0;for(const e of n.returns)s.setCell(t,r,e.timePeriod),s.setCell(o,r,e.value),++r}}parseUnderlyHoldings(e,t){const s=this.table;let n=0;for(const o of t){for(const t in o){const r=`${e}_UnderlyingHoldings_${t}`;s.setCell(r,n,o[t])}++n}}}const ns=ss;function os(e,t){return e.map((e=>{const s={identifier:e.id,identifierType:e.idType,holdingType:e.holdingType||t};return e.name&&(s.name=e.name),e.type&&(s.securityType=e.type),e.weight&&(s.weight=e.weight.toString()),s}))}function rs(e){return(e=e.map((e=>e instanceof Array?e.join("|"):e))).length?`UseMongoSecurities,RunInThread,${e.join(",")}`:""}class is extends Ae{constructor(e={}){super(e),this.converter=new ns(e?.converter),this.metadata={columns:{}},this.options=e}async load(){await super.load();const e=this.options,t=e.dataPoints,s=e.holdings||[];if(!t||!s.length)return this;const n=[],o=[];for(const e of s)Tt(e)&&n.push(e),Mt(e)&&o.push(e);const r={benchmarkId:e.benchmarkId||"XIUSA0010V",currencyId:e.currencyId};n.length>o.length?(r.type=3,r.holdings=os(n,r.type)):(r.type=2,r.holdings=os(o,r.type)),this.metadata.benchmarkId=r.benchmarkId;const i=this.api=this.api||new Se(e.api),a=new je("ecint/v1/xray/json",i.baseURL);switch(t.type){case"benchmark":a.searchParams.set("benchmarkDataPoints",rs(t.dataPoints));break;case"holding":a.searchParams.set("holdingDataPoints",rs(t.dataPoints));break;case"portfolio":a.searchParams.set("portfolioDataPoints",rs(t.dataPoints))}const l=await i.fetch(a,{body:JSON.stringify(JSON.stringify(r)),headers:{"Content-Type":"application/json"},method:"POST"}),c=await l.json();return this.converter.parse({json:c}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ae.DataConnector.registerType("MorningstarXRay",is);const as={GoalAnalysis:xe,SecurityDetails:Xe,SecurityCompare:et,RNANews:at,RiskScore:Pt,Shared:s,TimeSeries:Qt,XRay:is,InvestmentScreener:pt,InvestorPreferences:Ct,version:me};return t})()));
//# sourceMappingURL=connectors-morningstar.js.map